!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("core-next-validation",[],t):"object"==typeof exports?exports["core-next-validation"]=t():e["core-next-validation"]=t()}(this,(function(){return function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/dist/",r(r.s=3)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i={INVALID_TYPE:0,ENUM_MISMATCH:1,ANY_OF_MISSING:10,ONE_OF_MISSING:11,ONE_OF_MULTIPLE:12,NOT_PASSED:13,NUMBER_MULTIPLE_OF:100,NUMBER_MINIMUM:101,NUMBER_MINIMUM_EXCLUSIVE:102,NUMBER_MAXIMUM:103,NUMBER_MAXIMUM_EXCLUSIVE:104,NUMBER_NOT_A_NUMBER:105,STRING_LENGTH_SHORT:200,STRING_LENGTH_LONG:201,STRING_PATTERN:202,OBJECT_PROPERTIES_MINIMUM:300,OBJECT_PROPERTIES_MAXIMUM:301,OBJECT_REQUIRED:302,OBJECT_ADDITIONAL_PROPERTIES:303,OBJECT_DEPENDENCY_KEY:304,ARRAY_LENGTH_SHORT:400,ARRAY_LENGTH_LONG:401,ARRAY_UNIQUE:402,ARRAY_ADDITIONAL_ITEMS:403,FORMAT_CUSTOM:500,KEYWORD_CUSTOM:501,CIRCULAR_REFERENCE:600,UNKNOWN_PROPERTY:1e3};let n,s={};for(n in i)s[i[n]]=n;t.ERROR_CODES=i,t.ERROR_MESSAGES_DEFAULT={INVALID_TYPE:"Invalid type: {type} (expected {expected})",ENUM_MISMATCH:"No enum match for: {value}",ANY_OF_MISSING:'Data does not match any schemas from "anyOf"',ONE_OF_MISSING:'Data does not match any schemas from "oneOf"',ONE_OF_MULTIPLE:'Data is valid against more than one schema from "oneOf": indices {index1} and {index2}',NOT_PASSED:'Data matches schema from "not"',NUMBER_MULTIPLE_OF:"Value {value} is not a multiple of {multipleOf}",NUMBER_MINIMUM:"Value {value} is less than minimum {minimum}",NUMBER_MINIMUM_EXCLUSIVE:"Value {value} is equal to exclusive minimum {minimum}",NUMBER_MAXIMUM:"Value {value} is greater than maximum {maximum}",NUMBER_MAXIMUM_EXCLUSIVE:"Value {value} is equal to exclusive maximum {maximum}",NUMBER_NOT_A_NUMBER:"Value {value} is not a valid number",STRING_LENGTH_SHORT:"String is too short ({length} chars), minimum {minimum}",STRING_LENGTH_LONG:"String is too long ({length} chars), maximum {maximum}",STRING_PATTERN:"String does not match pattern: {pattern}",OBJECT_PROPERTIES_MINIMUM:"Too few properties defined ({propertyCount}), minimum {minimum}",OBJECT_PROPERTIES_MAXIMUM:"Too many properties defined ({propertyCount}), maximum {maximum}",OBJECT_REQUIRED:"Missing required property: {key}",OBJECT_ADDITIONAL_PROPERTIES:"Additional properties not allowed",OBJECT_DEPENDENCY_KEY:"Dependency failed - key must exist: {missing} (due to key: {key})",ARRAY_LENGTH_SHORT:"Array is too short ({length}), minimum {minimum}",ARRAY_LENGTH_LONG:"Array is too long ({length}), maximum {maximum}",ARRAY_UNIQUE:"Array items are not unique (indices {match1} and {match2})",ARRAY_ADDITIONAL_ITEMS:"Additional items not allowed",FORMAT_CUSTOM:"Format validation failed ({message})",KEYWORD_CUSTOM:"Keyword failed: {key} ({message})",CIRCULAR_REFERENCE:"Circular $refs: {urls}",UNKNOWN_PROPERTY:"Unknown property (not in schema)"},t.ValidationError=class{constructor(e,t,r,i,n,s){if(void 0===e)throw new Error("No code supplied for error: "+t);this.message=t,this.params=r,this.code=e,this.dataPath=i||"",this.schemaPath=n||"",this.subErrors=s||null;const a=new Error(this.message);if(this.stack=a.stack||a.stacktrace,!this.stack)try{throw a}catch(e){this.stack=e.stack||e.stacktrace}this.name="ValidationError"}prefixWith(e,t){if(null!==e&&(e=e.replace(/~/g,"~0").replace(/\//g,"~1"),this.dataPath="/"+e+this.dataPath),null!==t&&(t=t.replace(/~/g,"~0").replace(/\//g,"~1"),this.schemaPath="/"+t+this.schemaPath),null!==this.subErrors){let r=0,i=this.subErrors.length;for(r=0;r<i;r++)this.subErrors[r].prefixWith(e,t)}return this}},t.ErrorCodeLookup=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i={$schema:"http://json-schema.org/draft-04/schema#",title:"model",description:"Generated Schema",type:"object",properties:{}};t.default=e=>{let t,r,n,s,a=i,o=Object.keys(e),l=o.length;for(t=0;t<l;t++)for(n in r=o[t])if(r.hasOwnProperty(n)){s=a.properties[r]={};let t=typeof e[r];"object"===t?t=Array.isArray(e[r])?"array":"object":"number"===t&&(t=Number.isInteger(e[r])?"integer":"number"),s.type=t,s.description=String(r)}return a}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.URI_TEMPLATE_GLOBAL_MODIFIERS={"+":!0,"#":!0,".":!0,"/":!0,";":!0,"?":!0,"&":!0},t.URI_TEMPLATE_SUFFICES={"*":!0};const i=t.parseURI=e=>{const t=String(e).replace(/^\s+|\s+$/g,"").match(/^([^:\/?#]+:)?(\/\/(?:[^:@]*(?::[^:@]*)?@)?(([^:\/?#]*)(?::(\d*))?))?([^?#]*)(\?[^#]*)?(#[\s\S]*)?/);return t?{href:t[0]||"",protocol:t[1]||"",authority:t[2]||"",host:t[3]||"",hostname:t[4]||"",port:t[5]||"",pathname:t[6]||"",search:t[7]||"",hash:t[8]||""}:null},n=t.removeDotSegments=e=>{let t=[];return e.replace(/^(\.\.?(\/|$))+/,"").replace(/\/(\.(\/|$))+/g,"/").replace(/\/\.\.$/,"/../").replace(/\/?[^\/]*/g,(function(e){"/.."===e?t.pop():t.push(e)})),t.join("").replace(/^\//,"/"===e.charAt(0)?"/":"")},s=t.resolveUrl=(e,t)=>(t=i(t||""),e=i(e||""),t&&e?(t.protocol||e.protocol)+(t.protocol||t.authority?t.authority:e.authority)+n(t.protocol||t.authority||"/"===t.pathname.charAt(0)?t.pathname:t.pathname?(e.authority&&!e.pathname?"/":"")+e.pathname.slice(0,e.pathname.lastIndexOf("/")+1)+t.pathname:e.pathname)+(t.protocol||t.authority||t.pathname?t.search:t.search||e.search)+t.hash:null),a=(t.getDocumentUri=e=>e.split("#")[0],t.isTrustedUrl=(e,t)=>{if(t.substring(0,e.length)===e){let r=t.substring(e.length);if(t.length>0&&"/"===t.charAt(e.length-1)||"#"===r.charAt(0)||"?"===r.charAt(0))return!0}return!1},t.normSchema=(e,t)=>{if(e&&"object"==typeof e)if(void 0===t?t=e.id:"string"==typeof e.id&&(t=s(t,e.id),e.id=t),Array.isArray(e)){let r=0,i=e.length;for(r=0;r<i;r++)a(e[r],t)}else{"string"==typeof e.$ref&&(e.$ref=s(t,e.$ref));for(let r in e)"enum"!==r&&a(e[r],t)}})},function(e,t,r){"use strict";var i=s(r(4)),n=s(r(1));function s(e){return e&&e.__esModule?e:{default:e}}e.exports.ValidationFramework=i.default,e.exports.SchemaGenerator=n.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(r(1)),n=a(r(5)),s=r(0);function a(e){return e&&e.__esModule?e:{default:e}}t.default=class{constructor(){this._myValidator=(0,n.default)(),this._myValidator&&this._myValidator.addLanguage("en-us",s.ERROR_MESSAGES_DEFAULT)}supportsValidation(){return null!==this._myValidator}registerSchema(e,t){return this._myValidator.addSchema(e,t)}getSchema(e){return this._myValidator.getSchema(e)}getSchemas(){return this._myValidator.getSchemaMap()}clearSchemas(){this._myValidator.dropSchemas()}validate(e,t){return this._myValidator.validateMultiple(e,t)}getValidationMessages(){return this._myValidator.error}generateSchema(e){let t=e;return(0,i.default)(t)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(6),n=o(i),s=r(0),a=r(2);function o(e){return e&&e.__esModule?e:{default:e}}let l={};const h=e=>{const t=new n.default;let r=e||"en";return{addFormat:(e,r)=>{t.addFormat(e,r)},language:e=>e?(l[e]||(e=e.split("-")[0]),!!l[e]&&(r=e,e)):r,addLanguage:(e,t)=>{let r;for(r in s.ERROR_CODES)t[r]&&!t[s.ERROR_CODES[r]]&&(t[s.ERROR_CODES[r]]=t[r]);let i=e.split("-")[0];if(l[i])for(r in l[e]=Object.create(l[i]),t)void 0===l[i][r]&&(l[i][r]=t[r]),l[e][r]=t[r];else l[e]=t,l[i]=t},freshApi:e=>{const t=h();return e&&t.language(e),t},validate:(e,i,s,a)=>{const o=new n.default(t,!1,l[r],s,a);"string"==typeof i&&(i={$ref:i}),o.addSchema("",i);let h=o.validateAll(e,i,null,null,"");return!h&&a&&(h=o.banUnknownProperties()),(void 0).error=h,(void 0).missing=o.missing,(void 0).valid=null===h,(void 0).valid},validateResult:()=>{let e={};return(void 0).validate.apply(e,arguments),e},validateMultiple:(e,i,s,a)=>{const o=new n.default(t,!0,l[r],s,a);"string"==typeof i&&(i={$ref:i}),o.addSchema("",i),o.validateAll(e,i,null,null,""),a&&o.banUnknownProperties();let h={};return h.errors=o.errors,h.missing=o.missing,h.valid=0===h.errors.length,h},addSchema:(e,r)=>t.addSchema(e,r),getSchema:(e,r)=>t.getSchema(e,r),getSchemaMap:()=>t.getSchemaMap.apply(t,arguments),getSchemaUris:()=>t.getSchemaUris.apply(t,arguments),getMissingUris:()=>t.getMissingUris.apply(t,arguments),dropSchemas:()=>{t.dropSchemas.apply(t,arguments)},defineKeyword:()=>{t.defineKeyword.apply(t,arguments)},defineError:(e,t,r)=>{if("string"!=typeof e||!/^[A-Z]+(_[A-Z]+)*$/.test(e))throw new Error("Code name must be a string in UPPER_CASE_WITH_UNDERSCORES");if("number"!=typeof t||t%1!=0||t<1e4)throw new Error("Code number must be an integer > 10000");if(void 0!==s.ERROR_CODES[e])throw new Error("Error already defined: "+e+" as "+s.ERROR_CODES[e]);if(void 0!==s.ErrorCodeLookup[t])throw new Error("Error code already used: "+s.ErrorCodeLookup[t]+" as "+t);s.ERROR_CODES[e]=t,s.ErrorCodeLookup[t]=e,s.ERROR_MESSAGES_DEFAULT[e]=s.ERROR_MESSAGES_DEFAULT[t]=r;for(let r in l){let i=l[r];i[e]&&(i[t]=i[t]||i[e])}},reset:()=>{t.reset(),(void 0).error=null,(void 0).missing=[],(void 0).valid=!0},missing:[],error:null,valid:!0,normSchema:a.normSchema,resolveUrl:a.resolveUrl,getDocumentUri:a.getDocumentUri,errorCodes:s.ERROR_CODES}};t.default=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),n=r(2);let s=Math.pow(2,-51),a=1-s;class o{constructor(e,t,r,i,n){if(this.missing=[],this.missingMap={},this.formatValidators=e?Object.create(e.formatValidators):{},this.schemas=e?Object.create(e.schemas):{},this.collectMultiple=t,this.errors=[],this.handleError=t?this.collectError:this.returnError,i&&(this.checkRecursive=!0,this.scanned=[],this.scannedFrozen=[],this.scannedFrozenSchemas=[],this.scannedFrozenValidationErrors=[],this.validatedSchemasKey="tv4_validation_id",this.validationErrorsKey="tv4_validation_errors_id"),n&&(this.trackUnknownProperties=!0,this.knownPropertyPaths={},this.unknownPropertyPaths={}),this.errorMessages=r,this.definedKeywords={},e)for(let t in e.definedKeywords)this.definedKeywords[t]=e.definedKeywords[t].slice(0)}notReallyPercentEncode(e){return encodeURI(e).replace(/%25[0-9][0-9]/g,e=>"%"+e.substring(3))}uriTemplateSubstitution(e){let t="";URI_TEMPLATE_GLOBAL_MODIFIERS[e.charAt(0)]&&(t=e.charAt(0),e=e.substring(1));let r="",i="",n=!0,s=!1,a=!1;"+"===t?n=!1:"."===t?(i=".",r="."):"/"===t?(i="/",r="/"):"#"===t?(i="#",n=!1):";"===t?(i=";",r=";",s=!0,a=!0):"?"===t?(i="?",r="&",s=!0):"&"===t&&(i="&",r="&",s=!0);let o=[],l=e.split(","),h=[],u={},d=0,c=l.length;for(d=0;d<c;d++){let e=l[d],t=null;if(-1!==e.indexOf(":")){let r=e.split(":");e=r[0],t=parseInt(r[1],10)}let r={};for(;URI_TEMPLATE_SUFFICES[e.charAt(e.length-1)];)r[e.charAt(e.length-1)]=!0,e=e.substring(0,e.length-1);let i={truncate:t,name:e,suffices:r};h.push(i),u[e]=i,o.push(e)}const f=e=>{let t="",o=0,l=0,u=h.length;for(l=0;l<u;l++){let d=h[l];if(!e&&!isFunction(e))throw new Error("Problem qith value function.");let c=e(d.name);if(null==c||Array.isArray(c)&&0===c.length||"object"==typeof c&&0===Object.keys(c).length)o++;else if(t+=l===o?i:r||",",Array.isArray(c)){s&&(t+=d.name+"=");let e=0;for(u=c.length,e=0;e<u;e++)e>0&&(t+=d.suffices["*"]&&r||",",d.suffices["*"]&&s&&(t+=d.name+"=")),t+=n?encodeURIComponent(c[e]).replace(/!/g,"%21"):this.notReallyPercentEncode(c[e])}else if("object"==typeof c){s&&!d.suffices["*"]&&(t+=d.name+"=");let e=!0;for(let i in c)e||(t+=d.suffices["*"]&&r||","),e=!1,t+=n?encodeURIComponent(i).replace(/!/g,"%21"):this.notReallyPercentEncode(i),t+=d.suffices["*"]?"=":",",t+=n?encodeURIComponent(c[i]).replace(/!/g,"%21"):this.notReallyPercentEncode(c[i])}else s&&(t+=d.name,a&&""===c||(t+="=")),null!==d.truncate&&(c=c.substring(0,d.truncate)),t+=n?encodeURIComponent(c).replace(/!/g,"%21"):this.notReallyPercentEncode(c)}return t};return f.varNames=o,{prefix:i,substitution:f}}recursiveCompare(e,t){if(e===t)return!0;if("object"==typeof e&&"object"==typeof t){if(Array.isArray(e)!==Array.isArray(t))return!1;if(Array.isArray(e)){if(e.length!==t.length)return!1;let r=0,i=e.length;for(r=0;r<i;r++)if(!this.recursiveCompare(e[r],t[r]))return!1}else{let r;for(r in e)if(void 0===t[r]&&void 0!==e[r])return!1;for(r in t)if(void 0===e[r]&&void 0!==t[r])return!1;for(r in e)if(!this.recursiveCompare(e[r],t[r]))return!1}return!0}return!1}defineKeyword(e,t){this.definedKeywords[e]=this.definedKeywords[e]||[],this.definedKeywords[e].push(t)}createError(e,t,r,n,s){let a=this.errorMessages[e]||i.ERROR_MESSAGES_DEFAULT[e];if("string"!=typeof a)return new i.ValidationError(e,"Unknown error code "+e+": "+JSON.stringify(t),t,r,n,s);let o=a.replace(/\{([^{}]*)\}/g,(function(e,r){let i=t[r];return"string"==typeof i||"number"==typeof i?i:e}));return new i.ValidationError(e,o,t,r,n,s)}returnError(e){return e}collectError(e){return e&&this.errors.push(e),null}prefixErrors(e,t,r){let i=0,n=this.errors.length;for(i=e;i<n;i++)this.errors[i]=this.errors[i].prefixWith(t,r);return this}banUnknownProperties(){for(let e in this.unknownPropertyPaths){let t=this.createError(i.ERROR_CODES.UNKNOWN_PROPERTY,{path:e},e,""),r=this.handleError(t);if(r)return r}return null}addFormat(e,t){if("object"==typeof e){for(let t in e)this.addFormat(t,e[t]);return this}this.formatValidators[e]=t}resolveRefs(e,t){if(void 0!==e.$ref){if((t=t||{})[e.$ref])return this.createError(i.ERROR_CODES.CIRCULAR_REFERENCE,{urls:Object.keys(t).join(", ")},"","");t[e.$ref]=!0,e=this.getSchema(e.$ref,t)}return e}getSchema(e,t){let r;if(void 0!==this.schemas[e])return r=this.schemas[e],this.resolveRefs(r,t);let i=e,n="";if(-1!==e.indexOf("#")&&(n=e.substring(e.indexOf("#")+1),i=e.substring(0,e.indexOf("#"))),"object"==typeof this.schemas[i]){r=this.schemas[i];let e=decodeURIComponent(n);if(""===e)return this.resolveRefs(r,t);if("/"!==e.charAt(0))return;let s=e.split("/").slice(1),a=0,o=s.length;for(a=0;a<o;a++){let e=s[a].replace(/~1/g,"/").replace(/~0/g,"~");if(void 0===r[e]){r=void 0;break}r=r[e]}if(void 0!==r)return this.resolveRefs(r,t)}void 0===this.missing[i]&&(this.missing.push(i),this.missing[i]=i,this.missingMap[i]=i)}searchSchemas(e,t){if(Array.isArray(e)){let r=0,i=e.length;for(r=0;r<i;r++)this.searchSchemas(e[r],t)}else if(e&&"object"==typeof e){"string"==typeof e.id&&isTrustedUrl(t,e.id)&&void 0===this.schemas[e.id]&&(this.schemas[e.id]=e);for(let r in e)if("enum"!==r)if("object"==typeof e[r])this.searchSchemas(e[r],t);else if("$ref"===r){let t=(0,n.getDocumentUri)(e[r]);t&&void 0===this.schemas[t]&&void 0===this.missingMap[t]&&(this.missingMap[t]=t)}}}addSchema(e,t){if("string"!=typeof e||void 0===t){if("object"!=typeof e||"string"!=typeof e.id)return;e=(t=e).id}e===(0,n.getDocumentUri)(e)+"#"&&(e=(0,n.getDocumentUri)(e)),this.schemas[e]=t,delete this.missingMap[e],(0,n.normSchema)(t,e),this.searchSchemas(t,e)}getSchemaMap(){let e={};for(let t in this.schemas)e[t]=this.schemas[t];return e}getSchemaUris(e){let t=[];for(let r in this.schemas)e&&!e.test(r)||t.push(r);return t}getMissingUris(e){let t=[];for(let r in this.missingMap)e&&!e.test(r)||t.push(r);return t}dropSchemas(){this.schemas={},this.reset()}reset(){this.missing=[],this.missingMap={},this.errors=[]}validateAll(e,t,r,n,s){let a;if(!(t=this.resolveRefs(t)))return null;if(t instanceof i.ValidationError)return this.errors.push(t),t;let o,l=this.errors.length,h=null,u=null;if(this.checkRecursive&&e&&"object"==typeof e){if(a=!this.scanned.length,e[this.validatedSchemasKey]){let r=e[this.validatedSchemasKey].indexOf(t);if(-1!==r)return this.errors=this.errors.concat(e[this.validationErrorsKey][r]),null}if(Object.isFrozen(e)&&-1!==(o=this.scannedFrozen.indexOf(e))){let e=this.scannedFrozenSchemas[o].indexOf(t);if(-1!==e)return this.errors=this.errors.concat(this.scannedFrozenValidationErrors[o][e]),null}if(this.scanned.push(e),Object.isFrozen(e))-1===o&&(o=this.scannedFrozen.length,this.scannedFrozen.push(e),this.scannedFrozenSchemas.push([])),h=this.scannedFrozenSchemas[o].length,this.scannedFrozenSchemas[o][h]=t,this.scannedFrozenValidationErrors[o][h]=[];else{if(!e[this.validatedSchemasKey])try{Object.defineProperty(e,this.validatedSchemasKey,{value:[],configurable:!0}),Object.defineProperty(e,this.validationErrorsKey,{value:[],configurable:!0})}catch(t){e[this.validatedSchemasKey]=[],e[this.validationErrorsKey]=[]}u=e[this.validatedSchemasKey].length,e[this.validatedSchemasKey][u]=t,e[this.validationErrorsKey][u]=[]}}let d=this.errors.length,c=this.validateBasic(e,t,s)||this.validateNumeric(e,t,s)||this.validateString(e,t,s)||this.validateArray(e,t,s)||this.validateObject(e,t,s)||this.validateCombinations(e,t,s)||this.validateHypermedia(e,t,s)||this.validateFormat(e,t,s)||this.validateDefinedKeywords(e,t,s)||null;if(a){for(;this.scanned.length;){delete this.scanned.pop()[this.validatedSchemasKey]}this.scannedFrozen=[],this.scannedFrozenSchemas=[]}if(c||d!==this.errors.length)for(;r&&r.length||n&&n.length;){let e=r&&r.length?""+r.pop():null,t=n&&n.length?""+n.pop():null;c&&(c=c.prefixWith(e,t)),this.prefixErrors(d,e,t)}return null!==h?this.scannedFrozenValidationErrors[o][h]=this.errors.slice(l):null!==u&&(e[this.validationErrorsKey][u]=this.errors.slice(l)),this.handleError(c)}validateFormat(e,t){if("string"!=typeof t.format||!this.formatValidators[t.format])return null;let r=this.formatValidators[t.format].call(null,e,t);return"string"==typeof r||"number"==typeof r?this.createError(i.ERROR_CODES.FORMAT_CUSTOM,{message:r}).prefixWith(null,"format"):r&&"object"==typeof r?this.createError(i.ERROR_CODES.FORMAT_CUSTOM,{message:r.message||"?"},r.dataPath||null,r.schemaPath||"/format"):null}validateDefinedKeywords(e,t,r){for(let n in this.definedKeywords){if(void 0===t[n])continue;let s=this.definedKeywords[n],a=0,o=s.length;for(a=0;a<o;a++){let o=(0,s[a])(e,t[n],t,r);if("string"==typeof o||"number"==typeof o)return this.createError(i.ERROR_CODES.KEYWORD_CUSTOM,{key:n,message:o}).prefixWith(null,"format");if(o&&"object"==typeof o){let e=o.code;if("string"==typeof e){if(!i.ERROR_CODES[e])throw new Error("Undefined error code (use defineError): "+e);e=i.ERROR_CODES[e]}else"number"!=typeof e&&(e=i.ERROR_CODES.KEYWORD_CUSTOM);let t="object"==typeof o.message?o.message:{key:n,message:o.message||"?"},r=o.schemaPath||"/"+n.replace(/~/g,"~0").replace(/\//g,"~1");return this.createError(e,t,o.dataPath||null,r)}}}return null}validateBasic(e,t,r){let i=this.validateType(e,t,r);return i?i.prefixWith(null,"type"):null}validateType(e,t){if(void 0===t.type)return null;let r=typeof e;null===e?r="null":Array.isArray(e)&&(r="array");let n=t.type;"object"!=typeof n&&(n=[n]);let s=0,a=n.length;for(s=0;s<a;s++){let t=n[s];if(t===r||"integer"===t&&"number"===r&&e%1==0)return null}return this.createError(i.ERROR_CODES.INVALID_TYPE,{type:r,expected:n.join("/")})}validateEnum(e,t){if(void 0===t.enum)return null;let r=0,n=t.enum.length;for(r=0;r<n;r++){let i=t.enum[r];if(this.recursiveCompare(e,i))return null}return this.createError(i.ERROR_CODES.ENUM_MISMATCH,{value:"undefined"!=typeof JSON?JSON.stringify(e):e})}validateNumeric(e,t,r){return this.validateMultipleOf(e,t,r)||this.validateMinMax(e,t,r)||this.validateNaN(e,t,r)||null}validateMultipleOf(e,t){let r=t.multipleOf||t.divisibleBy;if(void 0===r)return null;if("number"==typeof e){let t=e/r%1;if(t>=s&&t<a)return this.createError(i.ERROR_CODES.NUMBER_MULTIPLE_OF,{value:e,multipleOf:r})}return null}validateMinMax(e,t){if("number"!=typeof e)return null;if(void 0!==t.minimum){if(e<t.minimum)return this.createError(i.ERROR_CODES.NUMBER_MINIMUM,{value:e,minimum:t.minimum}).prefixWith(null,"minimum");if(t.exclusiveMinimum&&e===t.minimum)return this.createError(i.ERROR_CODES.NUMBER_MINIMUM_EXCLUSIVE,{value:e,minimum:t.minimum}).prefixWith(null,"exclusiveMinimum")}if(void 0!==t.maximum){if(e>t.maximum)return this.createError(i.ERROR_CODES.NUMBER_MAXIMUM,{value:e,maximum:t.maximum}).prefixWith(null,"maximum");if(t.exclusiveMaximum&&e===t.maximum)return this.createError(i.ERROR_CODES.NUMBER_MAXIMUM_EXCLUSIVE,{value:e,maximum:t.maximum}).prefixWith(null,"exclusiveMaximum")}return null}validateNaN(e){return"number"!=typeof e?null:!0===isNaN(e)||e===1/0||e===-1/0?this.createError(i.ERROR_CODES.NUMBER_NOT_A_NUMBER,{value:e}).prefixWith(null,"type"):null}validateString(e,t,r){return this.validateStringLength(e,t,r)||this.validateStringPattern(e,t,r)||null}validateStringLength(e,t){return"string"!=typeof e?null:void 0!==t.minLength&&e.length<t.minLength?this.createError(i.ERROR_CODES.STRING_LENGTH_SHORT,{length:e.length,minimum:t.minLength}).prefixWith(null,"minLength"):void 0!==t.maxLength&&e.length>t.maxLength?this.createError(i.ERROR_CODES.STRING_LENGTH_LONG,{length:e.length,maximum:t.maxLength}).prefixWith(null,"maxLength"):null}validateStringPattern(e,t){if("string"!=typeof e||void 0===t.pattern)return null;return new RegExp(t.pattern).test(e)?null:this.createError(i.ERROR_CODES.STRING_PATTERN,{pattern:t.pattern}).prefixWith(null,"pattern")}validateArray(e,t,r){return Array.isArray(e)&&(this.validateArrayLength(e,t,r)||this.validateArrayUniqueItems(e,t,r)||this.validateArrayItems(e,t,r))||null}validateArrayLength(e,t){let r;return void 0!==t.minItems&&e.length<t.minItems&&(r=this.createError(i.ERROR_CODES.ARRAY_LENGTH_SHORT,{length:e.length,minimum:t.minItems}).prefixWith(null,"minItems"),this.handleError(r))?r:void 0!==t.maxItems&&e.length>t.maxItems&&(r=this.createError(i.ERROR_CODES.ARRAY_LENGTH_LONG,{length:e.length,maximum:t.maxItems}).prefixWith(null,"maxItems"),this.handleError(r))?r:null}validateArrayUniqueItems(e,t){if(t.uniqueItems){let t=0,r=e.length;for(t=0;t<r;t++){let n=0;for(n=t+1;n<r;n++)if(recursiveCompare(e[t],e[n])){let e=this.createError(i.ERROR_CODES.ARRAY_UNIQUE,{match1:t,match2:n}).prefixWith(null,"uniqueItems");if(this.handleError(e))return e}}}return null}validateArrayItems(e,t,r){if(void 0===t.items)return null;let n,s;if(Array.isArray(t.items)){let a=e.length;for(s=0;s<a;s++)if(s<t.items.length){if(n=this.validateAll(e[s],t.items[s],[s],["items",s],r+"/"+s))return n}else if(void 0!==t.additionalItems)if("boolean"==typeof t.additionalItems){if(!t.additionalItems&&(n=this.createError(i.ERROR_CODES.ARRAY_ADDITIONAL_ITEMS,{}).prefixWith(""+s,"additionalItems"),this.handleError(n)))return n}else if(n=this.validateAll(e[s],t.additionalItems,[s],["additionalItems"],r+"/"+s))return n}else{let i=e.length;for(s=0;s<i;s++)if(n=this.validateAll(e[s],t.items,[s],["items"],r+"/"+s))return n}return null}validateObject(e,t,r){return"object"!=typeof e||null===e||Array.isArray(e)?null:this.validateObjectMinMaxProperties(e,t,r)||this.validateObjectRequiredProperties(e,t,r)||this.validateObjectProperties(e,t,r)||this.validateObjectDependencies(e,t,r)||null}validateObjectMinMaxProperties(e,t){let r,n=Object.keys(e);return void 0!==t.minProperties&&n.length<t.minProperties&&(r=this.createError(i.ERROR_CODES.OBJECT_PROPERTIES_MINIMUM,{propertyCount:n.length,minimum:t.minProperties}).prefixWith(null,"minProperties"),this.handleError(r))?r:void 0!==t.maxProperties&&n.length>t.maxProperties&&(r=this.createError(i.ERROR_CODES.OBJECT_PROPERTIES_MAXIMUM,{propertyCount:n.length,maximum:t.maxProperties}).prefixWith(null,"maxProperties"),this.handleError(r))?r:null}validateObjectRequiredProperties(e,t){if(void 0!==t.required){let r=0,n=t.required.length;for(r=0;r<n;r++){let n=t.required[r];if(void 0===e[n]){let e=this.createError(i.ERROR_CODES.OBJECT_REQUIRED,{key:n}).prefixWith(null,""+r).prefixWith(null,"required");if(this.handleError(e))return e}}}return null}validateObjectProperties(e,t,r){let n;for(let s in e){let a=r+"/"+s.replace(/~/g,"~0").replace(/\//g,"~1"),o=!1;if(void 0!==t.properties&&void 0!==t.properties[s]&&(o=!0,n=this.validateAll(e[s],t.properties[s],[s],["properties",s],a)))return n;if(void 0!==t.patternProperties)for(let r in t.patternProperties){if(new RegExp(r).test(s)&&(o=!0,n=this.validateAll(e[s],t.patternProperties[r],[s],["patternProperties",r],a)))return n}if(o)this.trackUnknownProperties&&(this.knownPropertyPaths[a]=!0,delete this.unknownPropertyPaths[a]);else if(void 0!==t.additionalProperties){if(this.trackUnknownProperties&&(this.knownPropertyPaths[a]=!0,delete this.unknownPropertyPaths[a]),"boolean"==typeof t.additionalProperties){if(!t.additionalProperties&&(n=this.createError(i.ERROR_CODES.OBJECT_ADDITIONAL_PROPERTIES,{}).prefixWith(s,"additionalProperties"),this.handleError(n)))return n}else if(n=this.validateAll(e[s],t.additionalProperties,[s],["additionalProperties"],a))return n}else this.trackUnknownProperties&&!this.knownPropertyPaths[a]&&(this.unknownPropertyPaths[a]=!0)}return null}validateObjectDependencies(e,t,r){let n;if(void 0!==t.dependencies)for(let s in t.dependencies)if(void 0!==e[s]){let a=t.dependencies[s];if("string"==typeof a){if(void 0===e[a]&&(n=this.createError(i.ERROR_CODES.OBJECT_DEPENDENCY_KEY,{key:s,missing:a}).prefixWith(null,s).prefixWith(null,"dependencies"),this.handleError(n)))return n}else if(Array.isArray(a)){let t=0,r=a.lenth;for(t=0;t<r;t++){let r=a[t];if(void 0===e[r]&&(n=this.createError(i.ERROR_CODES.OBJECT_DEPENDENCY_KEY,{key:s,missing:r}).prefixWith(null,""+t).prefixWith(null,s).prefixWith(null,"dependencies"),this.handleError(n)))return n}}else if(n=this.validateAll(e,a,[],["dependencies",s],r))return n}return null}validateCombinations(e,t,r){return this.validateAllOf(e,t,r)||this.validateAnyOf(e,t,r)||this.validateOneOf(e,t,r)||this.validateNot(e,t,r)||null}validateAllOf(e,t,r){if(void 0===t.allOf)return null;let i,n=0,s=t.allOf.length;for(n=0;n<s;n++){let s=t.allOf[n];if(i=this.validateAll(e,s,[],["allOf",n],r))return i}return null}validateAnyOf(e,t,r){if(void 0===t.anyOf)return null;let n,s,a=[],o=this.errors.length;this.trackUnknownProperties&&(n=this.unknownPropertyPaths,s=this.knownPropertyPaths);let l=!0,h=0,u=t.anyOf.length;for(h=0;h<u;h++){this.trackUnknownProperties&&(this.unknownPropertyPaths={},this.knownPropertyPaths={});let i=t.anyOf[h],u=this.errors.length,d=this.validateAll(e,i,[],["anyOf",h],r);if(null===d&&u===this.errors.length){if(this.errors=this.errors.slice(0,o),this.trackUnknownProperties){for(let e in this.knownPropertyPaths)s[e]=!0,delete n[e];for(let e in this.unknownPropertyPaths)s[e]||(n[e]=!0);l=!1;continue}return null}d&&a.push(d.prefixWith(null,""+h).prefixWith(null,"anyOf"))}return this.trackUnknownProperties&&(this.unknownPropertyPaths=n,this.knownPropertyPaths=s),l?(a=a.concat(this.errors.slice(o)),this.errors=this.errors.slice(0,o),this.createError(i.ERROR_CODES.ANY_OF_MISSING,{},"","/anyOf",a)):void 0}validateOneOf(e,t,r){if(void 0===t.oneOf)return null;let n,s,a=null,o=[],l=this.errors.length;this.trackUnknownProperties&&(n=this.unknownPropertyPaths,s=this.knownPropertyPaths);let h=0,u=t.oneOf.length;for(h=0;h<u;h++){this.trackUnknownProperties&&(this.unknownPropertyPaths={},this.knownPropertyPaths={});let u=t.oneOf[h],d=this.errors.length,c=this.validateAll(e,u,[],["oneOf",h],r);if(null===c&&d===this.errors.length){if(null!==a)return this.errors=this.errors.slice(0,l),this.createError(i.ERROR_CODES.ONE_OF_MULTIPLE,{index1:a,index2:h},"","/oneOf");if(a=h,this.trackUnknownProperties){for(let e in this.knownPropertyPaths)s[e]=!0,delete n[e];for(let e in this.unknownPropertyPaths)s[e]||(n[e]=!0)}}else c&&o.push(c)}return this.trackUnknownProperties&&(this.unknownPropertyPaths=n,this.knownPropertyPaths=s),null===a?(o=o.concat(this.errors.slice(l)),this.errors=this.errors.slice(0,l),this.createError(i.ERROR_CODES.ONE_OF_MISSING,{},"","/oneOf",o)):(this.errors=this.errors.slice(0,l),null)}validateNot(e,t,r){if(void 0===t.not)return null;let n,s,a=this.errors.length;this.trackUnknownProperties&&(n=this.unknownPropertyPaths,s=this.knownPropertyPaths,this.unknownPropertyPaths={},this.knownPropertyPaths={});let o=this.validateAll(e,t.not,null,null,r),l=this.errors.slice(a);return this.errors=this.errors.slice(0,a),this.trackUnknownProperties&&(this.unknownPropertyPaths=n,this.knownPropertyPaths=s),null===o&&0===l.length?this.createError(i.ERROR_CODES.NOT_PASSED,{},"","/not"):null}validateHypermedia(e,t,r){if(!t.links)return null;let i,n=0,s=t.links.length;for(n=0;n<s;n++){let s=t.links[n];if("describedby"===s.rel){let t=new UriTemplate(s.href),a=!0,o=0,l=t.varNames.length;for(o=0;o<l;o++)if(!(t.varNames[o]in e)){a=!1;break}if(a){let s={$ref:t.fillFromObject(e)};if(i=this.validateAll(e,s,[],["links",n],r))return i}}}}}t.default=o=o}])}));
//# sourceMappingURL=core-next-validation.js.map